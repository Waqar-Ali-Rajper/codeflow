<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>CodeFlow ‚Äî Autonomous Code Review Agent</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Syne:wght@600;700;800&family=Outfit:wght@300;400;500;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}"/>
</head>
<body>

<!-- ===== ANIMATED BACKGROUND ===== -->
<div class="bg-canvas">
    <canvas id="particleCanvas"></canvas>
    <div class="bg-glow bg-glow-1"></div>
    <div class="bg-glow bg-glow-2"></div>
    <div class="bg-glow bg-glow-3"></div>
</div>

<!-- ===== HEADER ===== -->
<header class="header">
    <div class="header-left">
        <div class="logo">
            <div class="logo-icon">
                <svg width="36" height="36" viewBox="0 0 36 36" fill="none">
                    <defs>
                        <linearGradient id="logoGrad" x1="0" y1="0" x2="36" y2="36">
                            <stop offset="0%" stop-color="#22d3ee"/>
                            <stop offset="100%" stop-color="#6366f1"/>
                        </linearGradient>
                    </defs>
                    <rect width="36" height="36" rx="10" fill="url(#logoGrad)" opacity="0.15" stroke="url(#logoGrad)" stroke-width="1.5"/>
                    <path d="M10 18l5 5 11-11" stroke="#22d3ee" stroke-width="2.8" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M10 12l3-3 8 8" stroke="#6366f1" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" opacity="0.6"/>
                </svg>
            </div>
            <div class="logo-text-wrap">
                <span class="logo-text">Code<span class="logo-accent">Flow</span></span>
                <span class="logo-sub">Autonomous Code Review</span>
            </div>
        </div>
    </div>
    <div class="header-center">
        <div class="pipeline-steps">
            <div class="step active" id="step-analyze"><span class="step-num">01</span><span class="step-label">Analyze</span></div>
            <div class="step-arrow">‚Üí</div>
            <div class="step" id="step-fix"><span class="step-num">02</span><span class="step-label">Fix</span></div>
            <div class="step-arrow">‚Üí</div>
            <div class="step" id="step-test"><span class="step-num">03</span><span class="step-label">Test</span></div>
            <div class="step-arrow">‚Üí</div>
            <div class="step" id="step-verify"><span class="step-num">04</span><span class="step-label">Verify</span></div>
        </div>
    </div>
    <div class="header-right">
        <div id="quality-badge" class="quality-badge hidden">
            <div class="quality-ring">
                <svg width="38" height="38" viewBox="0 0 38 38">
                    <circle cx="19" cy="19" r="15" fill="none" stroke="#1e293b" stroke-width="4"/>
                    <circle cx="19" cy="19" r="15" fill="none" stroke="#22d3ee" stroke-width="4" stroke-linecap="round" id="quality-ring-fill" stroke-dasharray="94.2" stroke-dashoffset="94.2" transform="rotate(-90 19 19)"/>
                </svg>
                <span class="quality-num" id="quality-score-val">0</span>
            </div>
        </div>
        <div class="gemini-tag">
            <span class="gemini-dot"></span>
            <span>Gemini 3</span>
        </div>
    </div>
</header>

<!-- ===== MAIN LAYOUT ===== -->
<div class="main-layout">

    <!-- ===== LEFT: EDITOR PANEL ===== -->
    <div class="panel panel-editor">
        <div class="panel-top">
            <div class="panel-title"><span class="ptitle-icon">‚úèÔ∏è</span> Code Editor</div>
            <div class="editor-toolbar">
                <select id="language-select" class="lang-select">
                    <option value="python">üêç Python</option>
                    <option value="javascript">üü® JavaScript</option>
                    <option value="java">‚òï Java</option>
                    <option value="cpp">‚öôÔ∏è C++</option>
                    <option value="typescript">üîµ TypeScript</option>
                </select>
                <button class="btn-clear" onclick="clearAll()">‚úï Clear</button>
            </div>
        </div>

        <!-- Line Numbers + Editor -->
        <div class="editor-wrap">
            <div class="line-numbers" id="lineNumbers">1</div>
            <textarea id="code-input" class="code-editor" spellcheck="false"
                placeholder="# Paste your code here...&#10;# Example:&#10;&#10;def divide(a, b):&#10;    return a / b&#10;&#10;result = divide(10, 0)&#10;print(result)"
                oninput="updateLineNumbers()"></textarea>
        </div>

        <!-- Analyze Button -->
        <div class="editor-footer">
            <button class="btn-analyze" id="btn-analyze" onclick="analyzeCode()">
                <span class="btn-analyze-icon">
                    <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
                        <circle cx="8" cy="8" r="5.5" stroke="currentColor" stroke-width="2"/>
                        <path d="M12 12l3.5 3.5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </span>
                <span class="btn-analyze-text">Analyze Code</span>
                <span class="btn-analyze-shortcut">Ctrl+Enter</span>
            </button>
        </div>
    </div>

    <!-- ===== RIGHT: RESULTS PANEL ===== -->
    <div class="panel panel-results">

        <!-- Summary Cards -->
        <div id="summary-cards" class="summary-cards hidden">
            <div class="scard scard-critical"><span class="scard-val" id="count-critical">0</span><span class="scard-label">Critical</span><div class="scard-bar"></div></div>
            <div class="scard scard-high"><span class="scard-val" id="count-high">0</span><span class="scard-label">High</span><div class="scard-bar"></div></div>
            <div class="scard scard-medium"><span class="scard-val" id="count-medium">0</span><span class="scard-label">Medium</span><div class="scard-bar"></div></div>
            <div class="scard scard-low"><span class="scard-val" id="count-low">0</span><span class="scard-label">Low</span><div class="scard-bar"></div></div>
        </div>

        <!-- Bugs Header -->
        <div class="results-header">
            <div class="results-title"><span class="ptitle-icon">üêõ</span> Bugs Found <span class="bugs-badge hidden" id="bugs-badge">0</span></div>
        </div>

        <!-- Bugs List -->
        <div id="bugs-container" class="bugs-list">
            <div class="empty-state">
                <div class="empty-visual">
                    <div class="empty-circles">
                        <div class="ec ec-1"></div><div class="ec ec-2"></div><div class="ec ec-3"></div>
                    </div>
                </div>
                <p class="empty-title">Ready to Analyze</p>
                <p class="empty-desc">Paste your code and click Analyze<br/>to find bugs instantly with Gemini 3</p>
            </div>
        </div>

        <!-- Action Buttons -->
        <div id="action-buttons" class="action-btns hidden">
            <button class="btn-action btn-fix" onclick="fixCode()"><span>üîß</span> Auto-Fix</button>
            <button class="btn-action btn-tests" onclick="generateTests()"><span>üß™</span> Gen Tests</button>
        </div>

        <!-- Fixed Code Panel -->
        <div id="fixed-panel" class="sub-panel hidden">
            <div class="sub-panel-header">
                <span class="sub-panel-title"><span class="ptitle-icon">‚úÖ</span> Fixed Code</span>
                <div class="sub-panel-actions">
                    <button class="btn-mini btn-copy" onclick="copyFixedCode()">üìã Copy</button>
                    <button class="btn-mini btn-use" onclick="useFixedCode()">‚¨ÖÔ∏è Use</button>
                </div>
            </div>
            <pre id="fixed-code-display" class="code-display"></pre>
            <button class="btn-verify" onclick="verifyCode()">
                <span>üõ°Ô∏è</span> Verify Fix
            </button>
            <div id="verify-result" class="verify-box hidden"></div>
        </div>

        <!-- Tests Panel -->
        <div id="tests-panel" class="sub-panel hidden">
            <div class="sub-panel-header">
                <span class="sub-panel-title"><span class="ptitle-icon">üß™</span> Test Cases</span>
                <button class="btn-mini btn-copy" onclick="copyTestCode()">üìã Copy</button>
            </div>
            <div id="test-tags" class="test-tags"></div>
            <pre id="test-code-display" class="code-display"></pre>
        </div>
    </div>
</div>

<!-- ===== LOADING OVERLAY ===== -->
<div id="loading-overlay" class="loading-overlay hidden">
    <div class="loading-content">
        <div class="loading-rings">
            <div class="lr lr-1"></div>
            <div class="lr lr-2"></div>
            <div class="lr lr-3"></div>
        </div>
        <p class="loading-text" id="loading-text">Analyzing...</p>
        <div class="loading-progress"><div class="loading-bar" id="loading-bar"></div></div>
    </div>
</div>

<!-- ===== TOAST ===== -->
<div id="toast" class="toast hidden">
    <span class="toast-icon" id="toast-icon">‚úÖ</span>
    <span id="toast-text">Message</span>
</div>

<script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>